<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JavaScript 字符编码 | A simplified parser</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="A simplified parser">
    
    <link rel="preload" href="/a-simplified-parser/assets/css/0.styles.569c1002.css" as="style"><link rel="preload" href="/a-simplified-parser/assets/js/app.edec0845.js" as="script"><link rel="preload" href="/a-simplified-parser/assets/js/2.6e66ea0e.js" as="script"><link rel="preload" href="/a-simplified-parser/assets/js/9.8043b372.js" as="script"><link rel="prefetch" href="/a-simplified-parser/assets/js/10.052f7154.js"><link rel="prefetch" href="/a-simplified-parser/assets/js/11.8505c338.js"><link rel="prefetch" href="/a-simplified-parser/assets/js/12.dfcfd4d4.js"><link rel="prefetch" href="/a-simplified-parser/assets/js/13.bec14d99.js"><link rel="prefetch" href="/a-simplified-parser/assets/js/3.24ae4f42.js"><link rel="prefetch" href="/a-simplified-parser/assets/js/4.ff8e6064.js"><link rel="prefetch" href="/a-simplified-parser/assets/js/5.b5b7bce4.js"><link rel="prefetch" href="/a-simplified-parser/assets/js/6.471db325.js"><link rel="prefetch" href="/a-simplified-parser/assets/js/7.c343481e.js"><link rel="prefetch" href="/a-simplified-parser/assets/js/8.aeca95a5.js">
    <link rel="stylesheet" href="/a-simplified-parser/assets/css/0.styles.569c1002.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/a-simplified-parser/" class="home-link router-link-active"><!----> <span class="site-name">A simplified parser</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/a-simplified-parser/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/a-simplified-parser/" class="nav-link">
  Chinese
</a></li></ul></div></div><div class="nav-item"><a href="https://yangzheli.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/yangzheli/a-simplified-parser" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/a-simplified-parser/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/a-simplified-parser/" class="nav-link">
  Chinese
</a></li></ul></div></div><div class="nav-item"><a href="https://yangzheli.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/yangzheli/a-simplified-parser" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/a-simplified-parser/zh/introduce.html" class="sidebar-link">介绍</a></li><li><a href="/a-simplified-parser/zh/solution.html" class="sidebar-link">思路</a></li><li><a href="/a-simplified-parser/zh/encoding.html" aria-current="page" class="active sidebar-link">字符编码</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/a-simplified-parser/zh/encoding.html#unicode-字符集" class="sidebar-link">Unicode 字符集</a></li><li class="sidebar-sub-header"><a href="/a-simplified-parser/zh/encoding.html#转义字符" class="sidebar-link">转义字符</a></li><li class="sidebar-sub-header"><a href="/a-simplified-parser/zh/encoding.html#ucs-2-与-utf-16-编码" class="sidebar-link">UCS-2 与 UTF-16 编码</a></li><li class="sidebar-sub-header"><a href="/a-simplified-parser/zh/encoding.html#参考" class="sidebar-link">参考</a></li></ul></li><li><a href="/a-simplified-parser/zh/lexical.html" class="sidebar-link">词法分析</a></li><li><a href="/a-simplified-parser/zh/syntax.html" class="sidebar-link">语法分析</a></li><li><a href="/a-simplified-parser/zh/summary.html" class="sidebar-link">总结</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="javascript-字符编码"><a href="#javascript-字符编码" class="header-anchor">#</a> JavaScript 字符编码</h1> <p>在进行词法分析时，字符编码问题是不可避免的。比如对于字符 <code>'😀'</code> 或者类似 <code>'\x68'</code> 的转义字符，如何正确处理它们是必须要考虑的。因此在词法分析之前，先来讨论一下 JavaScript 的字符编码规则。</p> <h2 id="unicode-字符集"><a href="#unicode-字符集" class="header-anchor">#</a> Unicode 字符集</h2> <blockquote><p>A conforming implementation of ECMAScript must interpret source text input in conformance with the latest version of the Unicode Standard and ISO/IEC 10646.</p></blockquote> <p>根据 <a href="https://262.ecma-international.org/12.0/" target="_blank" rel="noopener noreferrer">ECMA262<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，ECMAScript 采用的是 <a href="https://unicode.org/versions/latest" target="_blank" rel="noopener noreferrer">Unicode<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 字符集。</p> <p>为涵盖世界上所有的字符，Unicode 字符共分为 17 个平面，每个平面包含 2^16 (65,536) 个码位 (code point)。其中 0 号平面称为基本平面 (BMP)，包含的码位从 <code>U+0000</code> 到 <code>U+FFFF</code>；剩余的 16 个平面称为辅助平面 (SMP)，包含的码位从 <code>U+010000</code> 到 <code>U+10FFFF</code>。</p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>目前 Unicode 13.0.0 包含 143,859 个字符。</p></div> <p>其中每个 Unicode 字符都有对应的码位，比如 <code>😀</code> 的码位为 <code>U+1F600</code>，可以在 <a href="https://www.unicode.org/charts/" target="_blank" rel="noopener noreferrer">Unicode 13.0 Character Code Charts<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 中找到每个码位对应的 Unicode 字符。</p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p><a href="https://www.unicode.org/emoji/charts-13.0/emoji-list.html" target="_blank" rel="noopener noreferrer">Emoji List<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 包含了所有的 Unicode 表情 😲</p></div> <h2 id="转义字符"><a href="#转义字符" class="header-anchor">#</a> 转义字符</h2> <p>除了直接使用 Unicode 字符外，还可以使用转义字符来表示它们。比如：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&gt;&gt;</span> <span class="token string">'\x68\x65\x6c\x6c\x6f'</span>
<span class="token string">'hello'</span>

<span class="token operator">&gt;&gt;</span> <span class="token string">'\u0068\u0065\u006c\u006c\u006f'</span>
<span class="token string">'hello'</span>
</code></pre></div><p>以 <code>\x</code> 开头，后接两位 16 进制数来表示码位从 <code>U+0000</code> 到 <code>U+00FF</code> 的 Unicode 字符；以 <code>\u</code> 开头，后接四位 16 进制数来表示码位从 <code>U+0000</code> 到 <code>U+FFFF</code> 的 Unicode 字符。转义字符表示的 Unicode 字符就是码位所对应的字符，如 <code>\x68</code> 和 <code>\u0068</code> 都表示字符 <code>h</code>。</p> <p>但是对于辅助平面的字符也能用上述方法表示吗？</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&gt;&gt;</span> <span class="token string">'\u1F600'</span>
<span class="token string">'ὠ0'</span>
</code></pre></div><p><code>U+1F600</code> 是 <code>😀</code> 的码位，但输出却不是预期的结果。这是因为 JavaScript 采用的是 <strong><code>UCS-2</code></strong> 编码，而非 <strong><code>UTF-16</code></strong>。</p> <h2 id="ucs-2-与-utf-16-编码"><a href="#ucs-2-与-utf-16-编码" class="header-anchor">#</a> UCS-2 与 UTF-16 编码</h2> <p><strong><code>UCS-2</code></strong> 是一种固定长度的编码格式，用来表示 2 个字节的字符，如果是 4 个字节的字符，会被当成两个 2 字节字符处理。因此 <code>\u1F600</code> 被当成两个单独的字符 <code>\u1F60</code> 和 <code>0</code>。</p> <p><strong><code>UTF-16</code></strong> 在 <strong><code>UCS-2</code></strong> 之后公布，它是 <strong><code>UCS-2</code></strong> 的超集，是一种可变长度的编码格式。<strong><code>UTF-16</code></strong> 既可以表示 2 个字节的字符 <code>U+0000</code> 到 <code>U+FFFF</code>，也可以表示 4 个字节的字符 <code>U+010000</code> 到 <code>U+10FFFF</code>。</p> <p>对于 2 个字节的字符，<strong><code>UTF-16</code></strong> 编码结果和 <strong><code>UCS-2</code></strong> 一致；而对于 4 个字节的字符， <strong><code>UTF-16</code></strong> 采用 <strong>代理对</strong> 来表示。</p> <p>在基本平面中 <code>U+D800</code> 到 <code>U+DFFF</code> 没有表示任何字符，它们用于映射辅助平面中的字符。代理对的前 2 个字节的字符总在 <code>U+D800</code>到 <code>U+DBFF</code> 之间，为高位代理 (H)；后 2 个字节的字符总在 <code>U+DC00</code>到 <code>U+DFFF</code> 之间，为低位代理 (L)。</p> <p>可以通过 <a href="http://unicode.org/versions/Unicode3.0.0/ch03.pdf" target="_blank" rel="noopener noreferrer">The Unicode Standard 3.0<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 中的转换公式来将辅助平面的码位 <code>C</code> 使用代理对 <code>&lt;H, L&gt;</code> 表示：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token constant">H</span> <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">C</span> <span class="token operator">-</span> <span class="token number">0x10000</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">0x400</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0xd800</span><span class="token punctuation">;</span>
<span class="token constant">L</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token constant">C</span> <span class="token operator">-</span> <span class="token number">0x10000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">0x400</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0xdc00</span><span class="token punctuation">;</span>
</code></pre></div><p>也可以用另一公式将代理对 <code>&lt;H, L&gt;</code> 转换回码位 <code>C</code>：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token constant">C</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">H</span> <span class="token operator">-</span> <span class="token number">0xd800</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0x400</span> <span class="token operator">+</span> <span class="token constant">L</span> <span class="token operator">-</span> <span class="token number">0xdc00</span> <span class="token operator">+</span> <span class="token number">0x10000</span><span class="token punctuation">;</span>
</code></pre></div><p>因此，上述示例中 <code>\u1F600</code> 使用代理对表示就是 <code>\ud83d \ude00</code>：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&gt;&gt;</span> <span class="token string">'\ud83d\ude00'</span>
<span class="token string">'😀'</span>
</code></pre></div><p>当然，对于 <strong><code>UCS-2</code></strong> 编码，除了使用代理对，<strong><code>ES2015</code></strong> 中还引入了一种新的 Unicode 字符表示法，只要将码位放入 <code>{}</code> 内，无论是基本平面还是辅助平面，都是正确识别。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&gt;&gt;</span> <span class="token string">'\u{0068}\u{0065}\u{006c}\u{006c}\u{006f}'</span>
<span class="token string">'hello'</span>

<span class="token operator">&gt;&gt;</span> <span class="token string">'\u{1F600}'</span>
<span class="token string">'😀'</span>
</code></pre></div><p>同时，<strong><code>ES2015</code></strong> 还增加了一些处理 Unicode 字符的方法：</p> <ul><li><strong><code>String.fromCodePoint()</code></strong>：返回 Unicode 码位对应的字符；</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&gt;&gt;</span> String<span class="token punctuation">.</span><span class="token function">fromCodePoint</span><span class="token punctuation">(</span><span class="token number">0x0068</span><span class="token punctuation">,</span> <span class="token number">0x0065</span><span class="token punctuation">,</span> <span class="token number">0x006c</span><span class="token punctuation">,</span> <span class="token number">0x006c</span><span class="token punctuation">,</span> <span class="token number">0x006f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token string">'hello'</span>

<span class="token operator">&gt;&gt;</span> String<span class="token punctuation">.</span><span class="token function">fromCodePoint</span><span class="token punctuation">(</span><span class="token number">0x1F600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token string">'😀'</span>

<span class="token operator">&gt;&gt;</span> String<span class="token punctuation">.</span><span class="token function">fromCodePoint</span><span class="token punctuation">(</span><span class="token number">0xd83d</span><span class="token punctuation">,</span> <span class="token number">0xde00</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token string">'😀'</span>
</code></pre></div><ul><li><strong><code>String.prototype.codePointAt()</code></strong>：返回给定索引字符对应的 Unicode 码位，它完整地处理整个字符而不是代理对的一部分；</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&gt;&gt;</span><span class="token string">'😀'</span><span class="token punctuation">.</span><span class="token function">codePointAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token number">128512</span> <span class="token comment">// 0x1F600</span>
</code></pre></div><ul><li><strong><code>String.prototype.charAt()</code></strong>：返回字符串给定索引的字符，它获取的一个代理项而不是整个字符。</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&gt;&gt;</span> <span class="token string">'😀'</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token string">'\ud83d'</span>

<span class="token operator">&gt;&gt;</span> <span class="token string">'😀'</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token string">'\ude00'</span>
</code></pre></div><p>对于正则表达式，<strong><code>ES2015</code></strong> 增加了修饰符 <code>u</code>，来正确处理辅助平面的 Unicode 字符。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&gt;&gt;</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^.$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'😀'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token boolean">false</span>

<span class="token operator">&gt;&gt;</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^.$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">u</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'😀'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token boolean">true</span>

<span class="token operator">&gt;&gt;</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[😀-😙]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'😘'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token string">'Uncaught SyntaxError: Invalid regular expression: /[😀-😙]/: Range out of order in character class'</span>

<span class="token operator">&gt;&gt;</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[😀-😙]</span><span class="token regex-delimiter">/</span><span class="token regex-flags">u</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'😘'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token boolean">true</span>
</code></pre></div><h2 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h2> <p><a href="https://mathiasbynens.be/notes/javascript-unicode" target="_blank" rel="noopener noreferrer">Mathias - JavaScript has a Unicode problem<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://mathiasbynens.be/notes/javascript-encoding" target="_blank" rel="noopener noreferrer">Mathias - JavaScript’s internal character encoding: UCS-2 or UTF-16?<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="http://www.ruanyifeng.com/blog/2014/12/unicode.html" target="_blank" rel="noopener noreferrer">阮一峰 - Unicode 与 JavaScript 详解<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/yangzheli/a-simplified-parser/edit/master/docs/zh/encoding.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2021/8/18上午1:48:06</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/a-simplified-parser/zh/solution.html" class="prev">
        思路
      </a></span> <span class="next"><a href="/a-simplified-parser/zh/lexical.html">
        词法分析
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/a-simplified-parser/assets/js/app.edec0845.js" defer></script><script src="/a-simplified-parser/assets/js/2.6e66ea0e.js" defer></script><script src="/a-simplified-parser/assets/js/9.8043b372.js" defer></script>
  </body>
</html>
